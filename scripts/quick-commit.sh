#!/bin/bash

# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∫–æ–º–º–∏—Ç - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./scripts/quick-commit.sh [—Å–æ–æ–±—â–µ–Ω–∏–µ]

set -e

GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m'

# –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
if [ -n "$1" ]; then
    COMMIT_MESSAGE="$*"
    echo -e "${BLUE}üìù –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${COMMIT_MESSAGE}${NC}"
else
    # –ò–Ω–∞—á–µ –∑–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
    echo -e "${BLUE}ü§ñ –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑...${NC}"
    ./scripts/auto-commit.sh
    exit 0
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if [ -z "$(git status --porcelain)" ]; then
    echo -e "${YELLOW}‚ö†Ô∏è –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞${NC}"
    exit 0
fi

# –î–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç
git add .
git commit -m "$COMMIT_MESSAGE"

echo -e "${GREEN}‚úÖ –ö–æ–º–º–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω: ${COMMIT_MESSAGE}${NC}"

# –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º push
read -p "üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ GitHub? (y/N): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    git push
    echo -e "${GREEN}üéâ –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!${NC}"
fi