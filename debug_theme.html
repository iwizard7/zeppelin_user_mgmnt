<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Theme Toggle</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/themes.css" rel="stylesheet">
    <style>
        .debug-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9999;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="debug-panel">
        <div><strong>üêõ –û–¢–õ–ê–î–ö–ê –¢–ï–ú–´</strong></div>
        <div id="debug-log">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <!-- –ù–∞–≤–±–∞—Ä -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <span class="navbar-brand">üöÄ Debug Theme</span>
            <div class="navbar-nav ms-auto d-flex align-items-center">
                <button id="navbar-theme-toggle" class="btn btn-outline-light btn-sm me-3" 
                    onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                    <span id="theme-icon">üåô</span>
                </button>
                <span class="navbar-text">
                    üë§ Debug User
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h5>üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã</h5>
            </div>
            <div class="card-body">
                <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üåô –≤ –Ω–∞–≤–±–∞—Ä–µ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã.</p>
                <p>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É.</p>
                <button onclick="manualTest()" class="btn btn-primary">üß™ –†—É—á–Ω–æ–π —Ç–µ—Å—Ç</button>
                <button onclick="clearDebug()" class="btn btn-secondary">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
            </div>
        </div>
    </div>

    <script>
        // –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥
        let debugMessages = [];
        
        function addDebugMessage(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugMessages.push(`[${timestamp}] ${message}`);
            updateDebugDisplay();
            console.log('üêõ', message);
        }
        
        function updateDebugDisplay() {
            const debugLog = document.getElementById('debug-log');
            if (debugLog) {
                debugLog.innerHTML = debugMessages.slice(-10).join('<br>');
            }
        }
        
        function clearDebug() {
            debugMessages = [];
            updateDebugDisplay();
        }
        
        // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
        (function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                addDebugMessage(`üìÇ –ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Ç–µ–º–∞: ${savedTheme}`);
            } else {
                addDebugMessage('üìÇ –¢–µ–º–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º light');
            }
        })();

        // –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –¢–ï–ú–´
        function toggleTheme() {
            addDebugMessage('üé® toggleTheme() –≤—ã–∑–≤–∞–Ω–∞');
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ç–µ–º—É
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                addDebugMessage(`üìä ${currentTheme} ‚Üí ${newTheme}`);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ–≤—É—é —Ç–µ–º—É
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                addDebugMessage(`üíæ –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: ${newTheme}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
                const icon = document.getElementById('theme-icon');
                if (icon) {
                    const oldIcon = icon.textContent;
                    icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                    addDebugMessage(`üéØ –ò–∫–æ–Ω–∫–∞: ${oldIcon} ‚Üí ${icon.textContent}`);
                } else {
                    addDebugMessage('‚ùå –ò–∫–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                }
                
                addDebugMessage('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
                
            } catch (error) {
                addDebugMessage('üí• –û–®–ò–ë–ö–ê: ' + error.message);
            }
        }
        
        // –†—É—á–Ω–æ–π —Ç–µ—Å—Ç
        function manualTest() {
            addDebugMessage('üß™ –†—É—á–Ω–æ–π —Ç–µ—Å—Ç –∑–∞–ø—É—â–µ–Ω');
            toggleTheme();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            addDebugMessage('üöÄ DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
            const button = document.getElementById('navbar-theme-toggle');
            const icon = document.getElementById('theme-icon');
            
            addDebugMessage(`üîç –ö–Ω–æ–ø–∫–∞ –Ω–∞–π–¥–µ–Ω–∞: ${!!button}`);
            addDebugMessage(`üîç –ò–∫–æ–Ω–∫–∞ –Ω–∞–π–¥–µ–Ω–∞: ${!!icon}`);
            
            if (button) {
                addDebugMessage(`üîç onclick: ${button.getAttribute('onclick')}`);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                button.addEventListener('click', function(e) {
                    addDebugMessage('üñ±Ô∏è addEventListener —Å—Ä–∞–±–æ—Ç–∞–ª');
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é
            addDebugMessage(`üîç toggleTheme –¥–æ—Å—Ç—É–ø–Ω–∞: ${typeof toggleTheme === 'function'}`);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–∫–æ–Ω–∫—É
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (icon) {
                icon.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                addDebugMessage(`üéØ –ù–∞—á–∞–ª—å–Ω–∞—è –∏–∫–æ–Ω–∫–∞: ${icon.textContent}`);
            }
            
            addDebugMessage('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
        });
    </script>
</body>
</html>